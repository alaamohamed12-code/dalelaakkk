# نظام الإشعارات - Notifications System

## نظرة عامة
تم إضافة نظام إشعارات كامل للموقع يسمح للأدمن بإرسال رسائل وتحديثات هامة للمستخدمين والشركات.

## المميزات
1. **إرسال إشعارات من لوحة الأدمن** - يمكن للأدمن كتابة رسالة واختيار الجهة المستهدفة
2. **تحديد الجهات المستهدفة**:
   - الكل (جميع المستخدمين والشركات)
   - الأفراد فقط
   - الشركات فقط
   - حساب محدد (عبر البريد الإلكتروني)
3. **عرض الإشعارات** - صفحة مخصصة لعرض جميع الإشعارات للمستخدم
4. **شارة العدد** - أيقونة جرس في الهيدر مع عدد الإشعارات غير المقروءة
5. **تعيين كمقروء** - يمكن للمستخدمين تعليم الإشعارات كمقروءة

## الملفات المضافة

### قاعدة البيانات
- `lib/notifications-db.ts` - طبقة قاعدة البيانات لإدارة الإشعارات

### API Routes
- `app/api/notifications/create/route.ts` - إنشاء إشعار جديد
- `app/api/notifications/route.ts` - جلب إشعارات المستخدم
- `app/api/notifications/mark-read/route.ts` - تعليم الإشعار كمقروء

### صفحات المستخدم
- `app/notifications/page.tsx` - صفحة عرض الإشعارات للمستخدمين
- `components/layout/Header.tsx` - إضافة أيقونة الإشعارات في الهيدر

### لوحة تحكم الأدمن
- `app/admin-panel/notifications/page.tsx` - صفحة إرسال الإشعارات
- `app/admin-panel/dashboard/page.tsx` - إضافة رابط لصفحة الإشعارات

## كيفية الاستخدام

### للأدمن
1. تسجيل الدخول إلى لوحة تحكم الأدمن
2. الضغط على زر "إرسال إشعارات"
3. كتابة الرسالة
4. اختيار الجهة المستهدفة:
   - **الكل**: سيتم إرسال الإشعار لجميع المستخدمين والشركات
   - **الأفراد فقط**: سيتم إرسال الإشعار للأفراد فقط
   - **الشركات فقط**: سيتم إرسال الإشعار للشركات فقط
   - **حساب محدد**: إدخال البريد الإلكتروني للمستخدم أو الشركة
5. الضغط على "إرسال الإشعار"

### للمستخدمين والشركات
1. عند تسجيل الدخول، ستظهر أيقونة جرس في الهيدر
2. إذا كان هناك إشعارات غير مقروءة، ستظهر شارة حمراء بالعدد
3. الضغط على أيقونة الجرس للانتقال إلى صفحة الإشعارات
4. يمكن تعليم أي إشعار كمقروء بالضغط على "تعيين كمقروء"

## جداول قاعدة البيانات

### notifications
- `id` - معرف فريد
- `message` - نص الإشعار
- `target` - الجهة المستهدفة (all, users, companies, custom)
- `targetEmail` - البريد الإلكتروني (للإشعارات المخصصة)
- `createdAt` - وقت الإنشاء
- `createdBy` - من قام بإنشاء الإشعار

### user_notifications
- `id` - معرف فريد
- `notificationId` - مرجع للإشعار
- `userId` - معرف المستخدم/الشركة
- `userEmail` - البريد الإلكتروني
- `accountType` - نوع الحساب (user, company)
- `isRead` - حالة القراءة (0 = غير مقروء, 1 = مقروء)
- `readAt` - وقت القراءة

## الميزات المستقبلية المحتملة
- إشعارات في الوقت الفعلي (WebSocket/Server-Sent Events)
- إمكانية حذف الإشعارات
- تصنيف الإشعارات (تحديث، تنبيه، إعلان، إلخ)
- إشعارات البريد الإلكتروني
- سجل الإشعارات في لوحة الأدمن
- جدولة الإشعارات
