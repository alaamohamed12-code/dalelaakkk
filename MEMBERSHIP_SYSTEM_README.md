# ูุธุงู ุงูุนุถููุฉ ููุดุฑูุงุช - Company Membership System

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุดุงูู ูุฅุฏุงุฑุฉ ุงูุนุถููุงุช ูุงูุงุดุชุฑุงูุงุช ููุดุฑูุงุช ูู ุงูููุตุฉ. ูุชูุญ ููุดุฑูุงุช ุงูุงุดุชุฑุงู ููุธููุฑ ูู ูุชุงุฆุฌ ุงูุจุญุซ ูุชููู ุทูุจุงุช ูู ุงูุนููุงุก.

## โจ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. ุฅุฏุงุฑุฉ ุงูุนุถููุงุช
- โ ุนุถููุงุช ุจูุชุฑุงุช ูุฎุชููุฉ (30ุ 90ุ 365 ููู)
- โ ุชุฌุฏูุฏ ุชููุงุฆู ุฃู ูุฏูู
- โ ุญุงูุงุช ุงูุนุถููุฉ (ูุดุทุฉ / ุบูุฑ ูุดุทุฉ)
- โ ุชุชุจุน ุชูุงุฑูุฎ ุงูุงูุชูุงุก

### 2. ูุธุงู ุงูุฅุดุนุงุฑุงุช
- ๐ ุชุญุฐูุฑุงุช ูุจู ุงูุชูุงุก ุงูุนุถููุฉ (7ุ 3ุ 1 ุฃูุงู)
- ๐ ุฅุดุนุงุฑ ุนูุฏ ุงูุชูุงุก ุงูุนุถููุฉ
- ๐ ุชุนุทูู ุชููุงุฆู ููุดุฑูุงุช ุงูููุชููุฉ

### 3. ููุญุฉ ุชุญูู ุงูุดุฑูุฉ
- ๐ ุนุฑุถ ุญุงูุฉ ุงูุนุถููุฉ ุงูุญุงููุฉ
- โฐ ุงูุนุฏ ุงูุชูุงุฒูู ููุฃูุงู ุงููุชุจููุฉ
- ๐ ุชุฌุฏูุฏ ุณุฑูุน (ุดูุฑุ 3 ุฃุดูุฑุ ุณูุฉ)
- ๐ Progress bar ุชูุงุนูู

### 4. ููุญุฉ ุชุญูู ุงูุฃุฏูู
- ๐ฅ ุนุฑุถ ุฌููุน ุนุถููุงุช ุงูุดุฑูุงุช
- ๐ง ุชูุนูู/ุชุนุทูู ุงูุนุถููุงุช ูุฏููุงู
- โ ุชูุฏูุฏ ุงูุนุถููุงุช
- ๐ ุฅุญุตุงุฆูุงุช ุดุงููุฉ
- ๐ ููุชุฑุฉ (ุงูููุ ูุดุทุฉุ ุบูุฑ ูุดุทุฉุ ุชูุชูู ูุฑูุจุงู)

### 5. ุงูุนุฑุถ ุงูุนุงู
- ๐จ ุดุงุฑุฉ "ุนุถููุฉ ูุดุทุฉ" ูู ุตูุญุงุช ุงูุจุฑููุงูู
- ๐๏ธ ุฅุฎูุงุก ุงูุดุฑูุงุช ุบูุฑ ุงููุดุทุฉ ูู ูุชุงุฆุฌ ุงูุจุญุซ
- โจ ุชุตููู UI ุฌุฐุงุจ ููุชุฌุงูุจ

## ๐๏ธ ุงููููุงุช ุงูุฃุณุงุณูุฉ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช
```
scripts/create-membership-system.js  - ุฅูุดุงุก ุงูุฌุฏุงูู ูุงูุญููู
scripts/check-membership-expiry.js   - ูุญุต ุงูุนุถููุงุช ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช
```

#### ุฌุฏูู `company_memberships`
```sql
- id (INTEGER PRIMARY KEY)
- companyId (INTEGER)
- status (TEXT) - active/inactive
- startDate (TEXT - ISO)
- endDate (TEXT - ISO)
- paymentDate (TEXT - ISO)
- paymentAmount (REAL)
- notificationSent (INTEGER) - 0,1,3,7
```

#### ุญููู ุฌุฏูุฏุฉ ูู `companies`
```sql
- membershipStatus (TEXT) - active/inactive
- membershipExpiry (TEXT - ISO)
```

### ุตูุญุงุช ุงููุงุฌูุฉ

#### ููุญุฉ ุชุญูู ุงูุดุฑูุฉ
```
app/company-dashboard/membership/page.tsx
```
- ุนุฑุถ ุญุงูุฉ ุงูุนุถููุฉ
- ุงูุฃูุงู ุงููุชุจููุฉ
- Progress bar
- ุฎุทุท ุงูุชุฌุฏูุฏ (30ุ 90ุ 365 ููู)

#### ููุญุฉ ุชุญูู ุงูุฃุฏูู
```
app/admin-panel/memberships/page.tsx
```
- ุฌุฏูู ุฌููุน ุงูุดุฑูุงุช
- ููุชุฑุฉ ูุชูุฏูุฉ
- ุฅุญุตุงุฆูุงุช ููุฑูุฉ
- ุฅุฏุงุฑุฉ ูุงููุฉ ููุนุถููุงุช

#### Navigation
```
components/company-dashboard/CompanyDashboardNav.tsx
```
- ูุงุฆูุฉ ุชููู ูุตูุญุงุช dashboard ุงูุดุฑูุฉ

### APIs

#### `/api/membership` (GET)
ุงุญุตู ุนูู ุจูุงูุงุช ุนุถููุฉ ุดุฑูุฉ ูุนููุฉ
```javascript
GET /api/membership?companyId=5
Response: {
  id, firstName, membershipStatus, membershipExpiry
}
```

#### `/api/membership/renew` (POST)
ุชุฌุฏูุฏ ุงูุนุถููุฉ
```javascript
POST /api/membership/renew
Body: { companyId: 5, days: 30 }
Response: {
  success: true,
  newExpiry: "2025-12-21T...",
  message: "Membership renewed successfully"
}
```

#### `/api/admin/memberships` (GET)
ุงุญุตู ุนูู ุฌููุน ุนุถููุงุช ุงูุดุฑูุงุช (Admin ููุท)
```javascript
GET /api/admin/memberships
Response: {
  companies: [...]
}
```

#### `/api/admin/memberships/toggle` (POST)
ุชูุนูู/ุชุนุทูู ุนุถููุฉ (Admin)
```javascript
POST /api/admin/memberships/toggle
Body: { companyId: 5, status: "active" }
```

#### `/api/admin/memberships/extend` (POST)
ุชูุฏูุฏ ุนุถููุฉ (Admin)
```javascript
POST /api/admin/memberships/extend
Body: { companyId: 5, days: 90 }
```

## ๐ ุงูุชุซุจูุช ูุงูุฅุนุฏุงุฏ

### 1. ุฅูุดุงุก ูุธุงู ุงูุนุถููุฉ
```bash
node scripts/create-membership-system.js
```
ูุฐุง ุงูุณูุฑูุจุช:
- ููุดุฆ ุฌุฏูู `company_memberships`
- ูุถูู ุญููู `membershipStatus` ู `membershipExpiry`
- ููุนูู ุนุถููุฉ ุชุฌุฑูุจูุฉ 30 ููู ูุฌููุน ุงูุดุฑูุงุช ุงูููุฌูุฏุฉ
- ููุดุฆ indexes ููุฃุฏุงุก

### 2. ุฌุฏููุฉ ูุญุต ุงูุนุถููุงุช (Cron Job)
```bash
# ุชุดุบูู ููููุงู ูู ููุชุตู ุงูููู
0 0 * * * cd /path/to/project && node scripts/check-membership-expiry.js
```

ุฃู ุนูู Windows Task Scheduler:
```powershell
# ุชุดุบูู ููููุงู ุงูุณุงุนุฉ 12 ุตุจุงุญุงู
schtasks /create /tn "Check Memberships" /tr "node d:\mahmoud hammad\scripts\check-membership-expiry.js" /sc daily /st 00:00
```

## ๐ ุณูุฑ ุงูุนูู (Workflow)

### 1. ุชุณุฌูู ุดุฑูุฉ ุฌุฏูุฏุฉ
```
ุงูุชุณุฌูู โ ุงูููุงููุฉ โ ุนุถููุฉ ุชุฌุฑูุจูุฉ 30 ููู ุชููุงุฆูุงู
```

### 2. ุฅุฏุงุฑุฉ ุงูุนุถููุฉ ูู ุงูุดุฑูุฉ
```
Dashboard โ ุงูุนุถููุฉ โ ุนุฑุถ ุงูุญุงูุฉ โ ุชุฌุฏูุฏ (30/90/365 ููู)
```

### 3. ุฅุฏุงุฑุฉ ูู ุงูุฃุฏูู
```
Admin Panel โ ุฅุฏุงุฑุฉ ุงูุนุถููุงุช โ ููุชุฑุฉ โ ุชูุนูู/ุชุนุทูู/ุชูุฏูุฏ
```

### 4. ุงูุชูุงุก ุงูุนุถููุฉ
```
ูุจู 7 ุฃูุงู โ ุฅุดุนุงุฑ
ูุจู 3 ุฃูุงู โ ุฅุดุนุงุฑ
ูุจู ููู ูุงุญุฏ โ ุฅุดุนุงุฑ
ุงูููู 0 โ ุชุนุทูู ุงูุนุถููุฉ โ ุฅุฎูุงุก ูู ูุชุงุฆุฌ ุงูุจุญุซ
```

## ๐ ุงูููุชุฑุฉ ูู APIs

### API ุงูุดุฑูุงุช ุงูุนุงูุฉ (`/api/companies`)
```sql
WHERE status = 'approved' 
AND membershipStatus = 'active' 
AND (membershipExpiry IS NULL OR membershipExpiry > NOW)
```

### API ุงูุจุฑููุงูู (`/api/company-profile`)
```javascript
if (isOwner) {
  // ุงููุงูู ูุฑู ูููู ุฏุงุฆูุงู
  query = "SELECT * WHERE id = ?"
} else {
  // ุงูุฒูุงุฑ ูุฑูู ุงููุดุทุฉ ููุท
  query += "AND membershipStatus = 'active' AND ..."
}
```

## ๐จ UI Components

### Badge ุงูุนุถููุฉ ุงููุดุทุฉ
```jsx
<div className="bg-gradient-to-r from-purple-500 to-pink-500 ...">
  <Shield icon />
  <span>ุนุถููุฉ ูุดุทุฉ</span>
</div>
```

### Progress Bar
```jsx
<div className="progress-bar">
  <div style={{ width: `${(daysLeft / 30) * 100}%` }} />
</div>
```

### ุฎุทุท ุงูุชุฌุฏูุฏ
```jsx
- ุดูุฑ ูุงุญุฏ (30 ููู) - ูุฌุงูู ุญุงููุงู
- 3 ุฃุดูุฑ (90 ููู) - Best Value
- ุณูุฉ ูุงููุฉ (365 ููู)
```

## ๐ ุงูุฅุญุตุงุฆูุงุช

### Dashboard ุงูุฃุฏูู
- ุฅุฌูุงูู ุงูุดุฑูุงุช
- ุนุถููุงุช ูุดุทุฉ
- ุนุถููุงุช ุบูุฑ ูุดุทุฉ
- ุชูุชูู ูุฑูุจุงู (ุฎูุงู 7 ุฃูุงู)

### ูุนูููุงุช ุงูุดุฑูุฉ
- ุงูุญุงูุฉ ุงูุญุงููุฉ (active/inactive)
- ุชุงุฑูุฎ ุงูุงูุชูุงุก
- ุงูุฃูุงู ุงููุชุจููุฉ
- ูุณุจุฉ ุงูููุช ุงููุชุจูู (progress)

## ๐ ุงูุฃูุงู

- โ ูุญุต ููุน ุงููุณุชุฎุฏู (company ููุท)
- โ ูุญุต ุตูุงุญูุงุช Admin
- โ ุงูุชุญูู ูู ููููุฉ ุงูุดุฑูุฉ
- โ ููุน ุงูุชูุงุนุจ ูู ุงูุชูุงุฑูุฎ

## ๐ ูุชุนุฏุฏ ุงููุบุงุช

ุงููุธุงู ูุฏุนู ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ:
```javascript
{lang === 'ar' ? 'ุนุถููุฉ ูุดุทุฉ' : 'Active Member'}
{lang === 'ar' ? 'ุงูุฃูุงู ุงููุชุจููุฉ' : 'Days Remaining'}
```

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช

### ูุชุฑุงุช ุงูุฅุดุนุงุฑุงุช
```javascript
const notificationPeriods = [7, 3, 1]; // ุฃูุงู ูุจู ุงูุงูุชูุงุก
```

### ุฎุทุท ุงูุนุถููุฉ
```javascript
const plans = [
  { days: 30, price: 0 },   // ุดูุฑ
  { days: 90, price: 0 },   // 3 ุฃุดูุฑ
  { days: 365, price: 0 }   // ุณูุฉ
];
```

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ุงูุดุฑูุฉ ูุง ุชุธูุฑ ูู ูุชุงุฆุฌ ุงูุจุญุซ
```sql
-- ุชุญูู ูู ุญุงูุฉ ุงูุนุถููุฉ
SELECT membershipStatus, membershipExpiry FROM companies WHERE id = ?

-- ุชูุนูู ูุฏููุงู
UPDATE companies SET membershipStatus = 'active', 
membershipExpiry = datetime('now', '+30 days') WHERE id = ?
```

### ุงููุดููุฉ: ุงูุฅุดุนุงุฑุงุช ูุง ุชุฑุณู
```bash
# ุชุดุบูู ุงูุณูุฑูุจุช ูุฏููุงู ููุชุญูู
node scripts/check-membership-expiry.js

# ุชุญูู ูู ุฌุฏูู ุงูุฅุดุนุงุฑุงุช
SELECT * FROM notifications WHERE type = 'membership_warning'
```

### ุงููุดููุฉ: ุงูุนุถููุฉ ุงูุชูุช ููู ุงูุดุฑูุฉ ุชุธูุฑ
```sql
-- ุชุญุฏูุซ ููุฑู ููุญุงูุฉ
UPDATE companies SET membershipStatus = 'inactive' 
WHERE membershipExpiry < datetime('now')
```

## ๐ ุงูููุงู ุงููุณุชูุจููุฉ (Optional)

- [ ] ุชูุงูู ุจูุงุจุฉ ุฏูุน ุญููููุฉ (Stripe/Fawry)
- [ ] ุฎุทุท ุฃุณุนุงุฑ ูุฎุชููุฉ
- [ ] ุฎุตููุงุช ูุนุฑูุถ ุชุฑููุฌูุฉ
- [ ] ุชูุงุฑูุฑ ูุงููุฉ
- [ ] ููุงุชูุฑ PDF
- [ ] ุฅุญุตุงุฆูุงุช ูุชูุฏูุฉ
- [ ] Email notifications
- [ ] Auto-renewal option

## ๐ฏ ุงูุฎูุงุตุฉ

ูุธุงู ุงูุนุถููุฉ ุงูุขู:
โ **ุฌุงูุฒ ููุฅูุชุงุฌ**
โ **ูุชูุงูู ุจุงููุงูู**
โ **ูุงุจู ููุชูุณุน**
โ **ุณูู ุงูุฅุฏุงุฑุฉ**

ููุดุฑูุงุช ุงูุฌุฏูุฏุฉ: ุชุญุตู ุนูู 30 ููู ูุฌุงูุงู ุชููุงุฆูุงู
ููุดุฑูุงุช ุงูุญุงููุฉ: ุชู ุชูุนูู 30 ููู ุชุฌุฑูุจู
ููุฃุฏูู: ุชุญูู ูุงูู ูู ุฌููุน ุงูุนุถููุงุช

---

**ุชู ุงูุชุทููุฑ:** ุฃูุชูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 1.0.0  
**ุงูุญุงูุฉ:** โ Production Ready
